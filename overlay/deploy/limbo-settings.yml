services:
  api:
    # Use a local tag or set via env
    image: ${LIMBO_IMAGE:-limbo:latest}
    ports:
      - "5001:5001"
    environment:
      # --- General ---
      DEBUG: "false"
      PRODUCTION: "false"
      LIDARR_METADATA_CONFIG: "BRIDGE"
      USE_CACHE: "true"
      ENABLE_STATS: "false"
      ROOT_PATH: ""

      # --- Redis ---
      REDIS_HOST: "redis"
      REDIS_PORT: "6379"

      # --- Solr mirror ---
      PROVIDERS__SOLRSEARCHPROVIDER__1__SEARCH_SERVER: "http://search:8983/solr"

      # --- MusicBrainz DB creds (set these to match your mirror) ---
      PROVIDERS__MUSICBRAINZDBPROVIDER__1__DB_HOST: "db"
      PROVIDERS__MUSICBRAINZDBPROVIDER__1__DB_PORT: "5432"
      PROVIDERS__MUSICBRAINZDBPROVIDER__1__DB_USER: "musicbrainz"
      PROVIDERS__MUSICBRAINZDBPROVIDER__1__DB_PASSWORD: "musicbrainz"

      # --- Postgres cache (lm_cache_db) ---
      # Uses lidarr:lidarr by default in upstream; ensure that user exists or adjust.
      POSTGRES_CACHE_HOST: "db"
      POSTGRES_CACHE_PORT: "5432"
      POSTGRES_CACHE_DB: "lm_cache_db"
      POSTGRES_CACHE_USER: "limbo"
      POSTGRES_CACHE_PASSWORD: "limbo"
      POSTGRES_CACHE_SCHEMA: "public"
      LIMBO_INIT_STATE_DIR: "/metadata/init-state"

      # --- External providers (fill in later) ---
      FANART_KEY: ""
      TADB_KEY: "2"
      LASTFM_KEY: ""
      LASTFM_SECRET: ""
      TIDAL_CLIENT_ID: ""
      TIDAL_CLIENT_SECRET: ""
      TIDAL_COUNTRY_CODE: ""
      TIDAL_USER: ""
      TIDAL_USER_PASSWORD: ""
      DISCOGS_KEY: ""
      SPOTIFY_ID: ""
      SPOTIFY_SECRET: ""
      SPOTIFY_REDIRECT_URL: "http://HOST_IP:5001"
